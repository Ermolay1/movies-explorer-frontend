{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\\\u041B\\u0435\\u0445\\u0430\\\\Documents\\\\dev\\\\first-project\\\\movies-explorer-frontend\\\\src\\\\components\\\\SavedMovies\\\\SavedMovies.js\",\n  _s = $RefreshSig$();\nimport Header from '../Header/Header';\nimport SearchForm from '../SearchForm/SearchForm';\nimport MoviesCardList from '../MoviesCardList/MoviesCardList';\nimport Footer from '../Footer/Footer';\nimport CurrentUserContext from '../../contexts/CurrentUserContext';\nimport { useState, useContext, useEffect } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { filterMovies,\n// фильтрация начального массива всех фильмов по запросу\nfilterShortMovies // фильтрация по длительности\n} from '../../utils/utils.js';\nimport useFormWithValidation from '../../hook/useFormWithValidation.jsx';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction SavedMovies(_ref) {\n  _s();\n  let {\n    onDeleteClick,\n    savedMoviesList,\n    setIsInfoTooltip,\n    loggedIn\n  } = _ref;\n  const location = useLocation();\n  const currentUser = useContext(CurrentUserContext);\n  const [shortMovies, setShortMovies] = useState(false);\n  const [NotFound, setNotFound] = useState(false);\n  const [showedMovies, setShowedMovies] = useState(savedMoviesList);\n  const [filteredMovies, setFilteredMovies] = useState(showedMovies);\n  const {\n    values,\n    handleChange,\n    isValid,\n    setIsValid\n  } = useFormWithValidation();\n  const [errorQuery, setErrorQuery] = useState('');\n  const input = values.search || '';\n  function handleSubmit(e) {\n    e.preventDefault();\n    isValid ? handleSearchSubmit(values.search) : setErrorQuery('Нужно ввести ключевое слово.');\n  }\n  ;\n  useEffect(() => {\n    setErrorQuery('');\n  }, [isValid]);\n  useEffect(() => {\n    if (location.pathname === '/movies' && localStorage.getItem(`currentUser - movieSearch`)) {\n      const searchValue = localStorage.getItem(`currentUser - movieSearch`);\n      values.search = searchValue;\n      setIsValid(true);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [currentUser]);\n  function handleSearchSubmit(inputValue) {\n    const moviesList = filterMovies(savedMoviesList, inputValue, shortMovies);\n    if (moviesList.length === 0) {\n      setNotFound(true);\n      setIsInfoTooltip({\n        isOpen: true,\n        successful: false,\n        text: 'Ничего не найдено.'\n      });\n    } else {\n      setNotFound(false);\n      setFilteredMovies(moviesList);\n      setShowedMovies(moviesList);\n    }\n  }\n  function handleShortFilms() {\n    if (!shortMovies) {\n      setShortMovies(true);\n      localStorage.setItem(`currentUser - shortSavedMovies`, true);\n      setShowedMovies(filterShortMovies(filteredMovies));\n      filterShortMovies(filteredMovies).length === 0 ? setNotFound(true) : setNotFound(false);\n    } else {\n      setShortMovies(false);\n      localStorage.setItem(`currentUser - shortSavedMovies`, false);\n      filteredMovies.length === 0 ? setNotFound(true) : setNotFound(false);\n      setShowedMovies(filteredMovies);\n    }\n  }\n  useEffect(() => {\n    if (localStorage.getItem(`currentUser - shortSavedMovies`) === 'true') {\n      setShortMovies(true);\n      setShowedMovies(filterShortMovies(savedMoviesList));\n    } else {\n      setShortMovies(false);\n      setShowedMovies(savedMoviesList);\n    }\n  }, [savedMoviesList, currentUser]);\n  useEffect(() => {\n    setFilteredMovies(savedMoviesList);\n    savedMoviesList.length !== 0 ? setNotFound(false) : setNotFound(true);\n  }, [savedMoviesList]);\n  useEffect(() => {\n    if (values.search !== undefined) {\n      handleSearchSubmit(values.search);\n      console.log(values.search);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [shortMovies]);\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"movies\",\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      loggedIn: loggedIn\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      children: [/*#__PURE__*/_jsxDEV(SearchForm, {\n        handleShortFilms: handleShortFilms,\n        shortMovies: shortMovies,\n        handleSubmit: handleSubmit,\n        handleChange: handleChange,\n        input: input,\n        errorQuery: errorQuery\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 17\n      }, this), !NotFound && /*#__PURE__*/_jsxDEV(MoviesCardList, {\n        moviesList: showedMovies,\n        savedMoviesList: savedMoviesList,\n        onDeleteClick: onDeleteClick\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 9\n  }, this);\n}\n_s(SavedMovies, \"AlNsVIVsHbPMfIB+FBQ6WtSGK2Y=\", false, function () {\n  return [useLocation, useFormWithValidation];\n});\n_c = SavedMovies;\nexport default SavedMovies;\nvar _c;\n$RefreshReg$(_c, \"SavedMovies\");","map":{"version":3,"names":["Header","SearchForm","MoviesCardList","Footer","CurrentUserContext","useState","useContext","useEffect","useLocation","filterMovies","filterShortMovies","useFormWithValidation","jsxDEV","_jsxDEV","SavedMovies","_ref","_s","onDeleteClick","savedMoviesList","setIsInfoTooltip","loggedIn","location","currentUser","shortMovies","setShortMovies","NotFound","setNotFound","showedMovies","setShowedMovies","filteredMovies","setFilteredMovies","values","handleChange","isValid","setIsValid","errorQuery","setErrorQuery","input","search","handleSubmit","e","preventDefault","handleSearchSubmit","pathname","localStorage","getItem","searchValue","inputValue","moviesList","length","isOpen","successful","text","handleShortFilms","setItem","undefined","console","log","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Леха/Documents/dev/first-project/movies-explorer-frontend/src/components/SavedMovies/SavedMovies.js"],"sourcesContent":["import Header from '../Header/Header'\nimport SearchForm from '../SearchForm/SearchForm'\nimport MoviesCardList from '../MoviesCardList/MoviesCardList'\nimport Footer from '../Footer/Footer'   \nimport CurrentUserContext from '../../contexts/CurrentUserContext';\nimport { useState, useContext, useEffect } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport {\n    filterMovies, // фильтрация начального массива всех фильмов по запросу\n    filterShortMovies, // фильтрация по длительности\n  } from '../../utils/utils.js';\n  import useFormWithValidation from '../../hook/useFormWithValidation.jsx';\n\nfunction SavedMovies({ onDeleteClick, savedMoviesList, setIsInfoTooltip, loggedIn }) {\n  const location = useLocation();\n  const currentUser = useContext(CurrentUserContext);\n  const [shortMovies, setShortMovies] = useState(false); \n  const [NotFound, setNotFound] = useState(false); \n  const [showedMovies, setShowedMovies] = useState(savedMoviesList); \n  const [filteredMovies, setFilteredMovies] = useState(showedMovies); \n  const { values, handleChange, isValid, setIsValid } = useFormWithValidation();\n  const [errorQuery, setErrorQuery] = useState('');\n  const input = values.search || ''\n\n\n  function handleSubmit(e) {\n    e.preventDefault();\n    isValid ? handleSearchSubmit(values.search) : setErrorQuery('Нужно ввести ключевое слово.');\n};\n\nuseEffect(() => {\n    setErrorQuery('')\n}, [isValid]);\n\nuseEffect(() => {\n    if (location.pathname === '/movies' && localStorage.getItem(`currentUser - movieSearch`)) {\n    const searchValue = localStorage.getItem(`currentUser - movieSearch`);\n    values.search = searchValue;\n    setIsValid(true);\n    }\n// eslint-disable-next-line react-hooks/exhaustive-deps\n}, [currentUser]);\n\n  function handleSearchSubmit(inputValue) {\n    const moviesList = filterMovies(savedMoviesList, inputValue, shortMovies);\n    if (moviesList.length === 0) {\n      setNotFound(true);\n      setIsInfoTooltip({\n        isOpen: true,\n        successful: false,\n        text: 'Ничего не найдено.',\n      });\n    } else {\n      setNotFound(false);\n      setFilteredMovies(moviesList);\n      setShowedMovies(moviesList);\n    }\n  }\n\n  function handleShortFilms() {\n    if (!shortMovies) {\n      setShortMovies(true);\n      localStorage.setItem(`currentUser - shortSavedMovies`, true);\n      setShowedMovies(filterShortMovies(filteredMovies));\n      filterShortMovies(filteredMovies).length === 0 ? setNotFound(true) : setNotFound(false);\n    } else {\n      setShortMovies(false);\n      localStorage.setItem(`currentUser - shortSavedMovies`, false);\n      filteredMovies.length === 0 ? setNotFound(true) : setNotFound(false);\n      setShowedMovies(filteredMovies);\n    }\n  }\n\n  useEffect(() => {\n    if (localStorage.getItem(`currentUser - shortSavedMovies`) === 'true') {\n      setShortMovies(true);\n      setShowedMovies(filterShortMovies(savedMoviesList));\n    } else {\n      setShortMovies(false);\n      setShowedMovies(savedMoviesList);\n    }\n  }, [savedMoviesList, currentUser]);\n\n  useEffect(() => {\n    setFilteredMovies(savedMoviesList);\n    savedMoviesList.length !== 0 ? setNotFound(false) : setNotFound(true);\n  }, [savedMoviesList]);\n\n  useEffect(() => {\n    if (values.search !== undefined) {\n    handleSearchSubmit(values.search);\n    console.log(values.search);\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [shortMovies])\n\n\n    return(\n        <section className=\"movies\">\n            <Header loggedIn={loggedIn} />\n            <main>\n                <SearchForm\n                handleShortFilms={handleShortFilms}\n                shortMovies={shortMovies}\n                handleSubmit={handleSubmit}\n                handleChange={handleChange}\n                input={input}\n                errorQuery={errorQuery}\n                />\n                {!NotFound && (\n                    <MoviesCardList\n                    moviesList={showedMovies}\n                    savedMoviesList={savedMoviesList}\n                    onDeleteClick={onDeleteClick}\n                    />\n                )}\n            </main>\n            <Footer />\n        </section>\n    );\n}\n\nexport default SavedMovies;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}