{"ast":null,"code":"import _slicedToArray from\"C:/Users/\\u041B\\u0435\\u0445\\u0430/Documents/dev/first-project/movies-explorer-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Header from'../Header/Header';import SearchForm from'../SearchForm/SearchForm';import MoviesCardList from'../MoviesCardList/MoviesCardList';import Footer from'../Footer/Footer';import CurrentUserContext from'../../contexts/CurrentUserContext';import{useState,useContext,useEffect}from'react';import{useLocation}from'react-router-dom';import{filterMovies,// фильтрация начального массива всех фильмов по запросу\nfilterShortMovies// фильтрация по длительности\n}from'../../utils/utils.js';import useFormWithValidation from'../../hook/useFormWithValidation.jsx';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function SavedMovies(_ref){var onDeleteClick=_ref.onDeleteClick,savedMoviesList=_ref.savedMoviesList,setIsInfoTooltip=_ref.setIsInfoTooltip,loggedIn=_ref.loggedIn;var location=useLocation();var currentUser=useContext(CurrentUserContext);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),shortMovies=_useState2[0],setShortMovies=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),NotFound=_useState4[0],setNotFound=_useState4[1];var _useState5=useState(savedMoviesList),_useState6=_slicedToArray(_useState5,2),showedMovies=_useState6[0],setShowedMovies=_useState6[1];var _useState7=useState(showedMovies),_useState8=_slicedToArray(_useState7,2),filteredMovies=_useState8[0],setFilteredMovies=_useState8[1];var _useFormWithValidatio=useFormWithValidation(),values=_useFormWithValidatio.values,handleChange=_useFormWithValidatio.handleChange,isValid=_useFormWithValidatio.isValid,setIsValid=_useFormWithValidatio.setIsValid;var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),errorQuery=_useState10[0],setErrorQuery=_useState10[1];var input=values.search||'';function handleSubmit(e){e.preventDefault();isValid?handleSearchSubmit(values.search):setErrorQuery('Нужно ввести ключевое слово.');};useEffect(function(){setErrorQuery('');},[isValid]);useEffect(function(){if(location.pathname==='/movies'&&localStorage.getItem(\"currentUser - movieSearch\")){var searchValue=localStorage.getItem(\"currentUser - movieSearch\");values.search=searchValue;setIsValid(true);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[currentUser]);function handleSearchSubmit(inputValue){var moviesList=filterMovies(savedMoviesList,inputValue,shortMovies);if(moviesList.length===0){setNotFound(true);setIsInfoTooltip({isOpen:true,successful:false,text:'Ничего не найдено.'});}else{setNotFound(false);setFilteredMovies(moviesList);setShowedMovies(moviesList);}}function handleShortFilms(){if(!shortMovies){setShortMovies(true);localStorage.setItem(\"currentUser - shortSavedMovies\",true);setShowedMovies(filterShortMovies(filteredMovies));filterShortMovies(filteredMovies).length===0?setNotFound(true):setNotFound(false);}else{setShortMovies(false);localStorage.setItem(\"currentUser - shortSavedMovies\",false);filteredMovies.length===0?setNotFound(true):setNotFound(false);setShowedMovies(filteredMovies);}}useEffect(function(){if(localStorage.getItem(\"currentUser - shortSavedMovies\")==='true'){setShortMovies(true);setShowedMovies(filterShortMovies(savedMoviesList));}else{setShortMovies(false);setShowedMovies(savedMoviesList);}},[savedMoviesList,currentUser]);useEffect(function(){setFilteredMovies(savedMoviesList);savedMoviesList.length!==0?setNotFound(false):setNotFound(true);},[savedMoviesList]);useEffect(function(){if(values.search!==undefined){handleSearchSubmit(values.search);console.log(values.search);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[shortMovies]);return/*#__PURE__*/_jsxs(\"section\",{className:\"movies\",children:[/*#__PURE__*/_jsx(Header,{loggedIn:loggedIn}),/*#__PURE__*/_jsxs(\"main\",{children:[/*#__PURE__*/_jsx(SearchForm,{handleShortFilms:handleShortFilms,shortMovies:shortMovies,handleSubmit:handleSubmit,handleChange:handleChange,input:input,errorQuery:errorQuery}),!NotFound&&/*#__PURE__*/_jsx(MoviesCardList,{moviesList:showedMovies,savedMoviesList:savedMoviesList,onDeleteClick:onDeleteClick})]}),/*#__PURE__*/_jsx(Footer,{})]});}export default SavedMovies;","map":{"version":3,"names":["Header","SearchForm","MoviesCardList","Footer","CurrentUserContext","useState","useContext","useEffect","useLocation","filterMovies","filterShortMovies","useFormWithValidation","jsx","_jsx","jsxs","_jsxs","SavedMovies","_ref","onDeleteClick","savedMoviesList","setIsInfoTooltip","loggedIn","location","currentUser","_useState","_useState2","_slicedToArray","shortMovies","setShortMovies","_useState3","_useState4","NotFound","setNotFound","_useState5","_useState6","showedMovies","setShowedMovies","_useState7","_useState8","filteredMovies","setFilteredMovies","_useFormWithValidatio","values","handleChange","isValid","setIsValid","_useState9","_useState10","errorQuery","setErrorQuery","input","search","handleSubmit","e","preventDefault","handleSearchSubmit","pathname","localStorage","getItem","searchValue","inputValue","moviesList","length","isOpen","successful","text","handleShortFilms","setItem","undefined","console","log","className","children"],"sources":["C:/Users/Леха/Documents/dev/first-project/movies-explorer-frontend/src/components/SavedMovies/SavedMovies.js"],"sourcesContent":["import Header from '../Header/Header'\nimport SearchForm from '../SearchForm/SearchForm'\nimport MoviesCardList from '../MoviesCardList/MoviesCardList'\nimport Footer from '../Footer/Footer'   \nimport CurrentUserContext from '../../contexts/CurrentUserContext';\nimport { useState, useContext, useEffect } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport {\n    filterMovies, // фильтрация начального массива всех фильмов по запросу\n    filterShortMovies, // фильтрация по длительности\n  } from '../../utils/utils.js';\n  import useFormWithValidation from '../../hook/useFormWithValidation.jsx';\n\nfunction SavedMovies({ onDeleteClick, savedMoviesList, setIsInfoTooltip, loggedIn }) {\n  const location = useLocation();\n  const currentUser = useContext(CurrentUserContext);\n  const [shortMovies, setShortMovies] = useState(false); \n  const [NotFound, setNotFound] = useState(false); \n  const [showedMovies, setShowedMovies] = useState(savedMoviesList); \n  const [filteredMovies, setFilteredMovies] = useState(showedMovies); \n  const { values, handleChange, isValid, setIsValid } = useFormWithValidation();\n  const [errorQuery, setErrorQuery] = useState('');\n  const input = values.search || ''\n\n\n  function handleSubmit(e) {\n    e.preventDefault();\n    isValid ? handleSearchSubmit(values.search) : setErrorQuery('Нужно ввести ключевое слово.');\n};\n\nuseEffect(() => {\n    setErrorQuery('')\n}, [isValid]);\n\nuseEffect(() => {\n    if (location.pathname === '/movies' && localStorage.getItem(`currentUser - movieSearch`)) {\n    const searchValue = localStorage.getItem(`currentUser - movieSearch`);\n    values.search = searchValue;\n    setIsValid(true);\n    }\n// eslint-disable-next-line react-hooks/exhaustive-deps\n}, [currentUser]);\n\n  function handleSearchSubmit(inputValue) {\n    const moviesList = filterMovies(savedMoviesList, inputValue, shortMovies);\n    if (moviesList.length === 0) {\n      setNotFound(true);\n      setIsInfoTooltip({\n        isOpen: true,\n        successful: false,\n        text: 'Ничего не найдено.',\n      });\n    } else {\n      setNotFound(false);\n      setFilteredMovies(moviesList);\n      setShowedMovies(moviesList);\n    }\n  }\n\n  function handleShortFilms() {\n    if (!shortMovies) {\n      setShortMovies(true);\n      localStorage.setItem(`currentUser - shortSavedMovies`, true);\n      setShowedMovies(filterShortMovies(filteredMovies));\n      filterShortMovies(filteredMovies).length === 0 ? setNotFound(true) : setNotFound(false);\n    } else {\n      setShortMovies(false);\n      localStorage.setItem(`currentUser - shortSavedMovies`, false);\n      filteredMovies.length === 0 ? setNotFound(true) : setNotFound(false);\n      setShowedMovies(filteredMovies);\n    }\n  }\n\n  useEffect(() => {\n    if (localStorage.getItem(`currentUser - shortSavedMovies`) === 'true') {\n      setShortMovies(true);\n      setShowedMovies(filterShortMovies(savedMoviesList));\n    } else {\n      setShortMovies(false);\n      setShowedMovies(savedMoviesList);\n    }\n  }, [savedMoviesList, currentUser]);\n\n  useEffect(() => {\n    setFilteredMovies(savedMoviesList);\n    savedMoviesList.length !== 0 ? setNotFound(false) : setNotFound(true);\n  }, [savedMoviesList]);\n\n  useEffect(() => {\n    if (values.search !== undefined) {\n    handleSearchSubmit(values.search);\n    console.log(values.search);\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [shortMovies])\n\n\n    return(\n        <section className=\"movies\">\n            <Header loggedIn={loggedIn} />\n            <main>\n                <SearchForm\n                handleShortFilms={handleShortFilms}\n                shortMovies={shortMovies}\n                handleSubmit={handleSubmit}\n                handleChange={handleChange}\n                input={input}\n                errorQuery={errorQuery}\n                />\n                {!NotFound && (\n                    <MoviesCardList\n                    moviesList={showedMovies}\n                    savedMoviesList={savedMoviesList}\n                    onDeleteClick={onDeleteClick}\n                    />\n                )}\n            </main>\n            <Footer />\n        </section>\n    );\n}\n\nexport default SavedMovies;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}